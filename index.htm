<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Anomalias</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f0f2f5; margin: 0; padding: 20px; color: #333; }
        
        /* TELA DE LOGIN (Simplificada) */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 9999; display: flex; justify-content: center; align-items: center; }
        .login-box { background: white; padding: 40px; border-radius: 12px; width: 350px; box-shadow: 0 15px 35px rgba(0,0,0,0.5); text-align: center; }
        .login-input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 6px; font-size: 16px; box-sizing: border-box; }
        .login-btn { width: 100%; padding: 12px; background: #0056b3; color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; font-weight: bold; margin-top: 10px; transition: 0.3s; }
        .login-btn:hover { background: #004494; }
        
        /* MODAL DE DETALHES */
        #detalhesModal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); backdrop-filter: blur(3px); }
        .modal-content { background-color: #fff; margin: 5% auto; padding: 25px; border-radius: 10px; width: 85%; max-width: 950px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); position: relative; }
        .close-btn { position: absolute; right: 20px; top: 15px; font-size: 28px; font-weight: bold; cursor: pointer; color: #aaa; }
        .close-btn:hover { color: #333; }

        /* DASHBOARD */
        .header { background: #fff; padding: 20px 30px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-left: 5px solid #0056b3; }
        .header h1 { margin: 0; font-size: 24px; color: #004085; }
        
        .kpi-container { display: flex; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; }
        .kpi-card { flex: 1; min-width: 200px; background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); border-left: 5px solid #ccc; }
        .kpi-card h3 { margin: 0 0 10px; font-size: 12px; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .kpi-card .value { font-size: 38px; font-weight: 700; color: #333; }
        .kpi-blue { border-left-color: #007bff; } .kpi-red { border-left-color: #dc3545; } 
        .kpi-orange { border-left-color: #fd7e14; } .kpi-green { border-left-color: #28a745; }

        /* TABELAS */
        .table-container { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.03); overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: separate; border-spacing: 0; min-width: 800px; }
        th { padding: 15px; text-align: left; background: #f8f9fa; color: #555; font-weight: 700; border-bottom: 2px solid #e9ecef; cursor: pointer; }
        td { padding: 12px 15px; border-bottom: 1px solid #f1f1f1; font-size: 14px; vertical-align: middle; }
        tr:hover { background-color: #f8f9fa; }
        
        .badge { padding: 5px 12px; border-radius: 20px; font-size: 11px; font-weight: bold; color: #fff; display: inline-block; min-width: 80px; text-align: center; }
        .bg-pendente { background-color: #dc3545; } .bg-atrasado { background-color: #fd7e14; } .bg-concluido { background-color: #28a745; }
        
        .tabela-detalhe { width: 100%; margin-top: 15px; }
        .tabela-detalhe th { background: #0056b3; color: white; font-size: 13px; }
        .tabela-detalhe td { border: 1px solid #dee2e6; font-size: 13px; vertical-align: top; }
        .tabela-detalhe tr:nth-child(even) { background-color: #f8f9fa; }
        .cat-tag { background: #e9ecef; color: #495057; padding: 3px 8px; border-radius: 4px; font-weight: bold; font-size: 11px; display: inline-block; white-space: nowrap; }
        .link-nome { color: #0056b3; font-weight: 600; cursor: pointer; text-decoration: none; }
        .link-nome:hover { text-decoration: underline; }
    </style>
</head>
<body>

    <div id="loginOverlay">
        <div class="login-box">
            <h2 style="color: #004085; margin-bottom: 20px;">Triunfante</h2>
            <p style="color: #666; margin-bottom: 20px;">Acesso Executivo</p>
            
            <input type="text" id="user" class="login-input" placeholder="Usu√°rio (ex: ademir)" onkeypress="handleEnter(event)">
            <input type="password" id="pass" class="login-input" placeholder="Senha" onkeypress="handleEnter(event)">
            
            <button class="login-btn" onclick="fazerLogin()">Entrar</button>
            <p id="errorMsg" style="color: red; font-size: 13px; margin-top: 15px; display: none;">Usu√°rio ou senha inv√°lidos.</p>
        </div>
    </div>

    <div id="detalhesModal">
        <div class="modal-content">
            <span class="close-btn" onclick="fecharModal()">&times;</span>
            <h2 id="modalTitulo" style="color: #004085; margin: 0 0 5px 0;">Detalhes</h2>
            <p id="modalSubtitulo" style="color: #666; margin: 0 0 20px 0;"></p>
            <div style="overflow-x: auto; max-height: 400px;">
                <table class="tabela-detalhe">
                    <thead>
                        <tr>
                            <th width="12%">Data</th>
                            <th width="10%">Status</th>
                            <th width="25%">Motivo (Auto)</th>
                            <th width="53%">Descri√ß√£o Original</th>
                        </tr>
                    </thead>
                    <tbody id="modalCorpo"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="dashboardContainer" style="display: none;">
        <div class="header">
            <div>
                <h1>Dashboard de Anomalias</h1>
                <small style="color: #666;">Monitoramento e Tratativas</small>
            </div>
            <div style="display: flex; gap: 15px; align-items: center;">
                <span id="userBadge" style="background: #e9ecef; padding: 6px 12px; border-radius: 4px; font-weight: bold; color: #555; font-size: 14px;"></span>
                <button onclick="logout()" style="padding: 8px 15px; border: 1px solid #ccc; background: white; border-radius: 4px; cursor: pointer; font-weight: bold;">Sair</button>
            </div>
        </div>

        <div class="kpi-container">
            <div class="kpi-card kpi-blue"><h3>Total Geral</h3><div class="value" id="kpiTotal">0</div></div>
            <div class="kpi-card kpi-red"><h3>Pendentes</h3><div class="value" id="kpiPendente">0</div></div>
            <div class="kpi-card kpi-orange"><h3>Atrasados</h3><div class="value" id="kpiAtrasado">0</div></div>
            <div class="kpi-card kpi-green"><h3>Conclu√≠dos</h3><div class="value" id="kpiConcluido">0</div></div>
        </div>

        <div style="display: flex; gap: 20px; flex-wrap: wrap;">
            <div class="table-container" style="flex: 1; min-width: 300px; height: 380px; margin-top:0;">
                <canvas id="chartStatus"></canvas>
            </div>
            <div class="table-container" style="flex: 1; min-width: 300px; height: 380px; margin-top:0;">
                <canvas id="chartResponsavel"></canvas>
            </div>
        </div>

        <div class="table-container">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3 style="margin: 0; color: #444;">üìã Vis√£o Detalhada</h3>
                <select id="filtroDiretoria" onchange="alterarFiltroDiretoria(this.value)" style="padding: 8px; border-radius: 4px; border: 1px solid #ccc;">
                </select>
            </div>
            <p style="font-size: 13px; color: #888; margin-top: 5px;">*Clique no nome para ver detalhes.</p>
            
            <table style="margin-top: 15px;">
                <thead>
                    <tr>
                        <th onclick="ordenar('filial')">Filial ‚Üï</th>
                        <th onclick="ordenar('responsavel')">Respons√°vel ‚Üï</th>
                        <th onclick="ordenar('anomalias')" style="text-align: center;">Anomalias ‚Üï</th>
                        <th onclick="ordenar('planos')" style="text-align: center;">Planos ‚Üï</th>
                        <th onclick="ordenar('status')" style="text-align: center;">Status Geral ‚Üï</th>
                        <th>A√ß√£o</th>
                    </tr>
                </thead>
                <tbody id="tabelaCorpo"></tbody>
            </table>
        </div>
    </div>

    <script>

// =================================================================
// PARTE 2: DADOS COMPLETOS (200 REGISTROS PROCESSADOS)
// =================================================================
const dadosBanco = [
    {"filial":"ABC","responsavel":"Missaid Mainardes","anomalias":1,"planos":4,"status":"Em Dia","diretoria":"Comercial","detalhes":[{"dt":"2025-11-12","st":"Em Dia","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade ABC apresentou R$ 1.050.735,23 em devolu√ß√µes, sendo..."}]},
    {"filial":"ABC","responsavel":"Nei Lessak","anomalias":4,"planos":2,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-11","st":"Conclu√≠do","cat":"Avaria","desc":"Referente SOLICITACAO DE BAIXA DE ESTOQUE POR AVARIA - REG-62208-543  , gentileza apresentar PLANO D..."},{"dt":"2025-11-11","st":"Conclu√≠do","cat":"Avaria","desc":"Referente SOLICITACAO DE BAIXA DE ESTOQUE POR AVARIA - REG-19233-716, gentileza apresentar PLANO DE ..."},{"dt":"2025-11-24","st":"Pendente","cat":"Avaria","desc":"Constata√ß√£o de ANOMALIA de AVARIAS, em 13NOV25, em ABC (REG 14653-624) que totalizou R$ 547,27, para..."},{"dt":"2025-11-24","st":"Pendente","cat":"Diverg√™ncia","desc":"Constata√ß√£o de ANOMALIA de SOBRAS, em 13NOV25, em ABC (REG 14653-624) que totalizou R$ 547,27, para ..."}]},
    {"filial":"API","responsavel":"Arildo Zago","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-13","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade API apresentou R$ 1.314.189,82 em devolu√ß√µes, com p..."}]},
    {"filial":"API","responsavel":"Magno Souza","anomalias":1,"planos":1,"status":"Conclu√≠do","diretoria":"Logistica","detalhes":[{"dt":"2025-11-13","st":"Conclu√≠do","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade API apresentou um total de R$ 1.314.189,82 em devol..."}]},
    {"filial":"API","responsavel":"Marcos Nichelle","anomalias":2,"planos":1,"status":"Atrasado","diretoria":"Comercial","detalhes":[{"dt":"2025-11-12","st":"Atrasado","cat":"Vencimento/FEFO","desc":"Produtos vencidos que estavam sendo sinalizados com anteced√™ncia para que ocorrerem a√ß√µes de vendas ..."},{"dt":"2025-11-19","st":"Pendente","cat":"Vencimento/FEFO","desc":"Elaborar plano de a√ß√£o para redu√ß√£o de vencidos..."}]},
    {"filial":"API","responsavel":"Ronaldo Crispim","anomalias":2,"planos":0,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-10-31","st":"Pendente","cat":"Outros","desc":"Ajustes de estoques constatados no inventario parcial que prrecisam de medidas tratativas ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Diverg√™ncia","desc":"Solicita√ß√£o de baixa de estoque, requer plano de a√ß√£o para reduzir as ocorr√™ncias dessas faltas e so..."}]},
    {"filial":"MCD","responsavel":"Ademir Lobato","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"O local apresenta uma grande quantidade de fezes de roedores, indicando infesta√ß√£o ativa. Essa condi..."}]},
    {"filial":"MCD","responsavel":"Cleverson Kuba","anomalias":6,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-04","st":"Pendente","cat":"Vencimento/FEFO","desc":"Produtos  topei pacoca vencidos no estoque validade 01/11/2025..."},{"dt":"2025-11-06","st":"Pendente","cat":"Vencimento/FEFO","desc":"produtos vencidos no  estoque por gentileza realizar processo de baixa..."},{"dt":"2025-11-13","st":"Pendente","cat":"Vencimento/FEFO","desc":"produtos vencidos no  estoque solicito por gentileza a baixa do iterm ...."},{"dt":"2025-11-14","st":"Pendente","cat":"Devolu√ß√£o","desc":"DANFE de devolu√ß√£o sem senha de devolu√ß√£o   ..."},{"dt":"2025-11-14","st":"Pendente","cat":"Devolu√ß√£o","desc":"danfe de devolu√ß√£o  sem a senha  de devolu√ß√£o solicito apoio sobre o assunto ..."},{"dt":"2025-11-17","st":"Pendente","cat":"Vencimento/FEFO","desc":"produto vencido no  estoque ..."}]},
    {"filial":"MCD","responsavel":"Emanuel Boscolo","anomalias":1,"planos":0,"status":"Conclu√≠do","diretoria":"Financeiro","detalhes":[{"dt":"2025-11-05","st":"Conclu√≠do","cat":"Fiscal/Financeiro","desc":"Na data de hoje(05/11/2025), na Unidade de MCD, teve um pagamento para a DUCOCO ALIMENTOS SA, NF 187..."}]},
    {"filial":"MCD","responsavel":"Fabio Rogerio","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-13","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade MCD apresentou R$ 4.221.881,60 em devolu√ß√µes, sendo..."}]},
    {"filial":"MCD","responsavel":"Jose Oscar","anomalias":15,"planos":0,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Encontrado roedor na carga de n√∫mero 10427 durante o processo de carregamento.  ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Encontrado  na rua k  posi√ß√£o k005 um roedor esmagado ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Presen√ßa  do item colgate prote√ß√£o  ativa misturados  com os demais  itens na posi√ß√£o o0040 ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Restos de equipe  descartado em local impr√≥prio ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Avaria","desc":"Produtos fracionados  fora do padrao  de organiza√ß√£o  Gerando avarias ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Produto desorganizado no pick fora de padr√£o ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Palet ra√ß√£o no a√©reo risco de queda ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Avaria","desc":"Avaria colgate com outros itens em bom estado de venda ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Avaria","desc":"Avarias no ch√£o  em v√°rias ruas de Mcd atraindo roedores pombos e moscas ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Placas de identifica√ß√£o  de rua no. Ch√£o ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Avaria","desc":"Avarias por consumo  indevido biscoito e batatas no final. Das. Ruasc..."},{"dt":"2025-11-11","st":"Pendente","cat":"Avaria","desc":"Lixo e sujeira junto com produtos  fracionados Gerando avaria fora de padr√£o de organiza√ß√£o ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Avaria","desc":"Fezes de roedores,produtos avariado em meio a produtos em bom estado podendo contaminar ..."},{"dt":"2025-11-16","st":"Pendente","cat":"Outros","desc":"Posi√ß√µes com risco de queda de produtos, pois esses produtos n√£o est√£o alocados de forma correta no ..."},{"dt":"2025-11-17","st":"Pendente","cat":"Avaria","desc":"sabonetes na rua N posi√ß√£o 57.0 molhando gerando avaria ..."}]},
    {"filial":"MCD","responsavel":"Magno Souza","anomalias":1,"planos":2,"status":"Em Dia","diretoria":"Logistica","detalhes":[{"dt":"2025-11-13","st":"Em Dia","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade MCD apresentou um total de R$ 4.221.881,60 em devol..."}]},
    {"filial":"TBE","responsavel":"Jonas Portela","anomalias":1,"planos":2,"status":"Em Dia","diretoria":"Logistica","detalhes":[{"dt":"2025-11-12","st":"Em Dia","cat":"Outros","desc":"Sa√≠das de Emerg√™ncia - Solicitado Lacres. Uma das sa√≠das, est√° obstru√≠da...."}]},
    {"filial":"TBE","responsavel":"Kelly Pereira","anomalias":1,"planos":1,"status":"Conclu√≠do","diretoria":"Gente","detalhes":[{"dt":"2025-10-30","st":"Conclu√≠do","cat":"Outros","desc":"Prezados,  Desde o dia 17/10/2025 estamos solicitando ao time de Gente e Gest√£o a lista de f√©rias do..."}]},
    {"filial":"TBE","responsavel":"Luis Fernando Feijo Ramos Junior","anomalias":2,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-12","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TBA apresentou R$ 830.282,30 em devolu√ß√µes, sendo p..."},{"dt":"2025-11-13","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TBE apresentou R$ 153.633,65 em devolu√ß√µes, com pre..."}]},
    {"filial":"TBE","responsavel":"Patricia Aline Sa Silva","anomalias":2,"planos":3,"status":"Atrasado","diretoria":"Financeiro","detalhes":[{"dt":"2025-10-30","st":"Atrasado","cat":"Fiscal/Financeiro","desc":"Na data de hoje 30/10/2025, foi informado dois ACORDOS COMERCIAIS em TPA, que n√£o foram inclu√≠dos no..."},{"dt":"2025-11-10","st":"Atrasado","cat":"Vencimento/FEFO","desc":"Diverg√™ncias nos pagamentos de TPA, na data de hoje 10/11/2025. A Unidade informou no DDA de TPA, um..."}]},
    {"filial":"TBE","responsavel":"Paulo Cholet","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-12","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TPA apresentou R$ 1.962.383,11 em devolu√ß√µes, sendo..."}]},
    {"filial":"TBL","responsavel":"Edson Bragato","anomalias":4,"planos":2,"status":"Atrasado","diretoria":"Logistica","detalhes":[{"dt":"2025-11-10","st":"Atrasado","cat":"Avaria","desc":"ASSUNTO: Avaria no ato da entrega ,chocolate derretido. CONSIDERANDO que devem ser tomados, pela Uni..."},{"dt":"2025-11-11","st":"Atrasado","cat":"Avaria","desc":"Realizado rondas de 5s em todos os corredores do  deposito (Unidade TBL) e foi constatados produtos ..."},{"dt":"2025-11-19","st":"Pendente","cat":"Vencimento/FEFO","desc":"Produtos Vencidos no estoque FEFO..."},{"dt":"2025-11-19","st":"Pendente","cat":"Avaria","desc":"Produtos com riscos de avarias fora das caixas..."}]},
    {"filial":"TBL","responsavel":"Everton Silva","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-12","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TBL apresentou R$ 985.792,13 em devolu√ß√µes, sendo a..."}]},
    {"filial":"TBL","responsavel":"Idin√©ia Leite","anomalias":1,"planos":3,"status":"Conclu√≠do","diretoria":"Financeiro","detalhes":[{"dt":"2025-11-10","st":"Conclu√≠do","cat":"Diverg√™ncia","desc":"Encontrado desvio no processo de solicita√ß√£o de baixa de estoque, onde um ajuste foi realizado ap√≥s ..."}]},
    {"filial":"TBL","responsavel":"Lucas Santana","anomalias":7,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-10-29","st":"Pendente","cat":"Vencimento/FEFO","desc":"Cliente: Casa Vila Real  NF 11925  Valor NF.R$:.94,68  Obs: 22 Unid. De √Ågua de Coco Puro Coco 200ml..."},{"dt":"2025-10-29","st":"Pendente","cat":"Vencimento/FEFO","desc":"Cliente: Casa Vila Real  NF 11925  Valor NF.R$:.94,68  Obs: 22 Unid. De √Ågua de Coco Puro Coco 200ml..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"Nota:.26796   Valor R$:. 1011,01 Valor Perda R$:. 71,37 Cliente:. MOLINS SUPERMERCADOS  PRODUTOS FOR..."},{"dt":"2025-10-30","st":"Pendente","cat":"Diverg√™ncia","desc":"NOTA FISCAL N¬∫ 19800 VALOR R$:. 653,27 CLIENTE:. MOLINS SUPERMERCADOS  MOTIVO: PRODUTOS DISCRIMINADO..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"NOTA FISCAL N¬∫ 10025 VALOR R$:. 187,80 CLIENTE: M L XAVIER SUPERMERCADOS  MOTIVO: PRODUTOS FORA DO P..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"NOTA FISCAL N¬∫ 8730 VALOR R$:. 259,24 CLIENTE: C R V ESTERO E CIA LTDA  MOTIVO: PRODUTOS FORA DO PRA..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"NOTA FISCAL N¬∫ 11925 VALOR R$:. 94,68 VALOR PERDA R$:. 54,78 CLIENTE: CASA VILA REAL  MOTIVO: PRODUT..."}]},
    {"filial":"TBL","responsavel":"Weverton Peixoto","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-06","st":"Pendente","cat":"Outros","desc":"No dia 06/11/2025 as 12h10min foi identificado o mau procedimento do colaborador La√©rcio (log√≠stica)..."}]},
    {"filial":"TCA","responsavel":"Becher Barros","anomalias":21,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-03","st":"Pendente","cat":"Diverg√™ncia","desc":"NF DE TROCA COM FALTA DE PRODUTOS E FORA DO PADR√ÉO DE RECEBIMENTO (90 DIAS)...."},{"dt":"2025-11-03","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF DE TROCA N 15116 COM DIVERG√äNCIA CLIENTE: SANTOGO ALIMENTOS LTDA DIVERG√äNCIAS: FALTA DE PRODUTOS ..."},{"dt":"2025-11-03","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF DE TROCA N 15116 COM DIVERG√äNCIA CLIENTE: SANTOGO ALIMENTOS LTDA DIVERG√äNCIAS: FALTA DE PRODUTOS ..."},{"dt":"2025-11-03","st":"Pendente","cat":"Diverg√™ncia","desc":"NF DE TROCA N 2662 COM DIVERG√äNCIA CLIENTE: TODO DIA LTDA  DIVERG√äNCIA: FALTA DE PRODUTO..."},{"dt":"2025-11-03","st":"Pendente","cat":"Diverg√™ncia","desc":"NF DE TROCA N 2661 COM DIVERG√äNCIA CLIENTE: TODO DIA LTDA  DIVERG√äNCIA: FALTA DE PRODUTO..."},{"dt":"2025-11-03","st":"Pendente","cat":"Diverg√™ncia","desc":"NFS DE TROCA N 40525, 40526, 40527, 40528, 40529, 40530 E 40531 COM DIVERG√äNCIAS. CLIENTE: TROPICAL ..."},{"dt":"2025-11-07","st":"Pendente","cat":"Diverg√™ncia","desc":"NF DE TROCA FORA DO PADR√ÉO DE RECEBIMENTO CONSTA FALTA DE PRODUTOS AP√ìS AUDITORIA...."},{"dt":"2025-11-12","st":"Pendente","cat":"Outros","desc":"NF de troca 8352 Produtos fora do padr√£o de recebimento +60 dias..."},{"dt":"2025-11-12","st":"Pendente","cat":"Diverg√™ncia","desc":"NF de troca - 1177 Falta de produtos..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 8769 Produtos fora do prazo de recebimento + 60 dias..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 39717 Produtos fora do prazo de recebimento +60 dias..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 39716 Produtos fora do prazo de rebimento +60 dias..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 39719 Produtos fora do prazo de recebimento + 60 dias..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 39718 Produtos fora do prazo de recebimento +60 dias..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 8766 Produtos fora do prazo de recebimento +60 dias/faltas..."},{"dt":"2025-11-12","st":"Pendente","cat":"Diverg√™ncia","desc":"NF de troca - 24348 Produtos fora do padr√£o de recebimento - faltas..."},{"dt":"2025-11-12","st":"Pendente","cat":"Diverg√™ncia","desc":"NF de troca - 310 Fora do padr√£o de recebimento - falta de produtos..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 16263 Produto fora do prazo de recebimento + 60 dias..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"NF de troca - 66 Produto fora do prazo de recebimento +60 dias/faltas..."},{"dt":"2025-11-21","st":"Pendente","cat":"Outros","desc":"NF de troca 123692 Produtos com a validade fora do padr√£o de recebimento Datas: 2023/2024..."},{"dt":"2025-11-21","st":"Pendente","cat":"Outros","desc":"NF de troca 123694 Produtos com validade fora do padr√£o de recebimento. Datas: 2023/2024..."}]},
    {"filial":"TCA","responsavel":"Jos√© Lima","anomalias":14,"planos":9,"status":"Atrasado","diretoria":"Logistica","detalhes":[{"dt":"2025-10-30","st":"Atrasado","cat":"Vencimento/FEFO","desc":"Produtos vencidos ainda presentes no pick Colaboradores j√° cientes do vencimento...."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"PRODUTO VENCIDO PRESENTE NO PICK COLABORADORES CIENTES DO VENCIMENTO..."},{"dt":"2025-11-03","st":"Atrasado","cat":"Devolu√ß√£o","desc":"Processo de confer√™ncia interrompido Conferente abandona devolu√ß√£o no meio da confer√™ncia ap√≥s ser c..."},{"dt":"2025-11-03","st":"Atrasado","cat":"Outros","desc":"Refrigerador com defeito, n√£o faz degelo Acionar manuten√ß√£o..."},{"dt":"2025-11-03","st":"Atrasado","cat":"Diverg√™ncia","desc":"Falta de organiza√ß√£o de picking Produtos fora das caixas ..."},{"dt":"2025-11-03","st":"Conclu√≠do","cat":"Outros","desc":"Produtos em caixa no ch√£o..."},{"dt":"2025-11-03","st":"Atrasado","cat":"Outros","desc":"Paletes mal posicionados e sem strech no a√©reo...."},{"dt":"2025-11-03","st":"Atrasado","cat":"Devolu√ß√£o","desc":"Demora na aloca√ß√£o de produtos Ocupando espa√ßo reservado para avarias/devolu√ß√£o...."},{"dt":"2025-11-07","st":"Atrasado","cat":"Avaria","desc":"Avarias deixadas em local inapropriado, podendo atrair pombos/pragas. Sem formul√°rio de avarias pree..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"PRODUTOS FORA DAS CAIXAS ..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"PRODUTOS FORA DAS CAIXAS..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"PRODUTOS FORA DAS CAIXAS..."},{"dt":"2025-11-19","st":"Pendente","cat":"Outros","desc":"Produto deixado no ch√£o..."},{"dt":"2025-11-19","st":"Pendente","cat":"Outros","desc":"L√¢mpadas queimadas presentes em todas as docas, necess√°rio manuten√ß√£o..."}]},
    {"filial":"TCA","responsavel":"Yasmin Silva","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-13","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TCA apresentou R$ 1.731.923,40 em devolu√ß√µes, com p..."}]},
    {"filial":"TCG","responsavel":"Cleverson Kuba","anomalias":26,"planos":2,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-10-30","st":"Conclu√≠do","cat":"Devolu√ß√£o","desc":"Notas de devolu√ß√£o sem pedido do cliente. Nfs: 14824 13628 13630 14262..."},{"dt":"2025-10-30","st":"Conclu√≠do","cat":"Devolu√ß√£o","desc":"Notas de devolu√ß√£o sem senha. √â de suma import√¢ncia e necess√°rio que os vendedores atendam e forneca..."},{"dt":"2025-10-31","st":"Pendente","cat":"Avaria","desc":"Justificativa: CONSUMO INDEVIDO E MANUSEIO INCORRETO INTERNO NA UNIDADE POR PARTE DA OPERA√áAO SEGUE ..."},{"dt":"2025-10-31","st":"Pendente","cat":"Vencimento/FEFO","desc":"SOLICITA√á√ÉO DE BAIXA  Justificativa: PRODUTO VENCIDO NO ESTOQUE  Unidade: TCG  Motivo: Vencimento  S..."},{"dt":"2025-10-31","st":"Pendente","cat":"Vencimento/FEFO","desc":"Data da Solicita√ß√£o: 2025-10-29  Solicitante: LUANA FERREIRA (PREVEN√á√ÉO PERDAS)   Justificativa: PRO..."},{"dt":"2025-11-03","st":"Pendente","cat":"Devolu√ß√£o","desc":"Nota de devolu√ß√£o,onde o cliente n√£o solicitou o pedido. Segue evid√™ncias...."},{"dt":"2025-11-03","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas sem senha. Segue para averigua√ß√£o as imagens das notas,e solicita√ß√£o para que os vendedores at..."},{"dt":"2025-11-03","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas sem senha...."},{"dt":"2025-11-04","st":"Pendente","cat":"Vencimento/FEFO","desc":"Solicita√ß√£o de baixa referente a vencimento. C√≥digo: 14200111 Produto: Yokitos An√©is de Cebola 01x10..."},{"dt":"2025-11-05","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas sem senha. Motorista informa que os vendedores n√£o est√£o atendendo para fornecer senhas...."},{"dt":"2025-11-06","st":"Pendente","cat":"Vencimento/FEFO","desc":"produto vencido no estoque. Por gentileza solicito a baixa dos seguintes produtos, pois os mesmo ja ..."},{"dt":"2025-11-10","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas sem senha. Motoristas continuam afirmando que os vendedores n√£o est√£o fornecendo a senha , poi..."},{"dt":"2025-11-12","st":"Pendente","cat":"Vencimento/FEFO","desc":"Solicita√ß√£o de baixa, produto vencido, dentro da unidade...."},{"dt":"2025-11-13","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TCG apresentou R$ 3.829.517,77 em devolu√ß√µes, com p..."},{"dt":"2025-11-13","st":"Pendente","cat":"Vencimento/FEFO","desc":"Solicita√ß√£o de baixa, por motivo de data de vencimento expirada. Segue evidencia, com c√≥digo, descri..."},{"dt":"2025-11-17","st":"Pendente","cat":"Devolu√ß√£o","desc":"Nota de devolu√ß√£o,onde o cliente n√£o solicitau o pedido. Por gentileza seguir os padr√µes corretos,co..."},{"dt":"2025-11-17","st":"Pendente","cat":"Devolu√ß√£o","desc":"Notas de devolu√ß√£o sem senha...."},{"dt":"2025-11-19","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas sem senha...."},{"dt":"2025-11-19","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas sem senha..."},{"dt":"2025-11-19","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas devolvidas devido ao cliente n√£o ter solicitado o pedido. Total das notas=606,28 em pedidos na..."},{"dt":"2025-11-19","st":"Pendente","cat":"Vencimento/FEFO","desc":"Fefo,solicita√ß√£o de baixa produto com data expirada...."},{"dt":"2025-11-19","st":"Pendente","cat":"Vencimento/FEFO","desc":"Produto vencido dentro da unidade,necess√°rio baixa...."},{"dt":"2025-11-22","st":"Pendente","cat":"Vencimento/FEFO","desc":"Produto vencido no estoque. Segue evid√™ncia para baixa...."},{"dt":"2025-11-22","st":"Pendente","cat":"Vencimento/FEFO","desc":"Produto com data de vencimento expirada. Segue evid√™ncia para solicita√ß√£o de baixa...."},{"dt":"2025-11-24","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Notas sem senha...."},{"dt":"2025-11-24","st":"Pendente","cat":"Devolu√ß√£o","desc":"Notas devolu√ß√£o, cliente nao solicitou...."}]},
    {"filial":"TCG","responsavel":"Ian Jantsch","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-25","st":"Pendente","cat":"Diverg√™ncia","desc":"Prezados, Refa√ßo um alerta importante referente ao procedimento de seguran√ßa nas docas do dep√≥sito. ..."}]},
    {"filial":"TCG","responsavel":"Jose Oscar","anomalias":10,"planos":0,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-14","st":"Pendente","cat":"Diverg√™ncia","desc":"Produtos misturados , aliment√≠cios com outros produtos,que nao fazem parte do mesmo segmento. Gerand..."},{"dt":"2025-11-14","st":"Pendente","cat":"Avaria","desc":"Gostaria de forma cordial,uma revis√£o das condi√ß√µes de organiza√ß√£o da unidade MCD E TCG,sendo que na..."},{"dt":"2025-11-14","st":"Pendente","cat":"Avaria","desc":"Gostaria de forma cordial,uma revis√£o das condi√ß√µes de organiza√ß√£o da unidade MCD E TCG,sendo que na..."},{"dt":"2025-11-14","st":"Pendente","cat":"Avaria","desc":"Gostaria de forma cordial,uma revis√£o das condi√ß√µes de organiza√ß√£o da unidade MCD E TCG,sendo que na..."},{"dt":"2025-11-14","st":"Pendente","cat":"Avaria","desc":"Gostaria de forma cordial,uma revis√£o das condi√ß√µes de organiza√ß√£o da unidade MCD E TCG,sendo que na..."},{"dt":"2025-11-14","st":"Pendente","cat":"Avaria","desc":"Gostaria de forma cordial,uma revis√£o das condi√ß√µes de organiza√ß√£o da unidade MCD E TCG,sendo que na..."},{"dt":"2025-11-14","st":"Pendente","cat":"Avaria","desc":"Produtos com altos √≠ndices de avarias, constatado diariamente por falta de manuseio correto,devido a..."},{"dt":"2025-11-17","st":"Pendente","cat":"Avaria","desc":"REFERENTE REGISTRO DE BAIXA POR AVARIA 89278-263 DE 24OUT25 - Abertura de anomalia para que se justi..."},{"dt":"2025-11-22","st":"Pendente","cat":"Diverg√™ncia","desc":"Gostaria de solicitar por gentileza, uma aten√ß√£o redobrada quanto a organiza√ß√£o dos produtos na oper..."},{"dt":"2025-11-24","st":"Pendente","cat":"Avaria","desc":"Produtos avaria interna Degusta√ß√£o indevida,manuseio incorreto,armazenamento impr√≥prio...."}]},
    {"filial":"TCG","responsavel":"Leonardo Rosa","anomalias":1,"planos":1,"status":"Conclu√≠do","diretoria":"Comercial","detalhes":[{"dt":"2025-10-30","st":"Conclu√≠do","cat":"Devolu√ß√£o","desc":"Motivo da Devolu√ß√£o: 5127 conta como: atraso da logistica. conforme relato no e-mail 30/10 enviado p..."}]},
    {"filial":"TCG","responsavel":"Magno Souza","anomalias":4,"planos":5,"status":"Em Dia","diretoria":"Logistica","detalhes":[{"dt":"2025-10-31","st":"Em Dia","cat":"Avaria","desc":" Solicitante:LUANA FERREIRA  Justificativa: CONSUMO INDEVIDO E MANUSEIO INCORRETO INTERNO NA UNIDADE..."},{"dt":"2025-11-11","st":"Em Dia","cat":"Avaria","desc":"Solicitacao de baixa, avaria interna,devido a degusta√ß√£o indevida no interior da unidade,manuseio in..."},{"dt":"2025-11-11","st":"Conclu√≠do","cat":"Avaria","desc":"Segue solicita√ß√£o de baixa, avarias por degusta√ß√£o indevida, armazenamento incorreto (fracionados), ..."},{"dt":"2025-11-13","st":"Em Dia","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TCG apresentou um total de R$ 3.829.517,77 em devol..."}]},
    {"filial":"TCV","responsavel":"Carlos Eduardo da Silva Camargo","anomalias":1,"planos":1,"status":"Atrasado","diretoria":"Comercial","detalhes":[{"dt":"2025-11-12","st":"Atrasado","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TCV apresentou R$ 1.832.519,53 em devolu√ß√µes, sendo..."}]},
    {"filial":"TCV","responsavel":"Christian Miranda","anomalias":1,"planos":0,"status":"Conclu√≠do","diretoria":"Comercial","detalhes":[{"dt":"2025-11-10","st":"Conclu√≠do","cat":"Outros","desc":"teste- Validar o sistema SIG..."}]},
    {"filial":"TCV","responsavel":"Graciele Patricia da Silva","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Financeiro","detalhes":[{"dt":"2025-11-25","st":"Pendente","cat":"Outros","desc":"Graciele, equipe de CPD realizou a baixa no sistema, pois a NF est√° anexa, por√©m n√£o atualizou o sta..."}]},
    {"filial":"TCV","responsavel":"Nei Lessak","anomalias":4,"planos":3,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-11","st":"Em Dia","cat":"Avaria","desc":"Referente SOLICITACAO DE BAIXA DE ESTOQUE POR AVARIA - REG-33156-226, gentileza apresentar PLANO DE ..."},{"dt":"2025-11-11","st":"Em Dia","cat":"Avaria","desc":"Referente SOLICITACAO DE BAIXA DE ESTOQUE POR AVARIA - REG-54086-345, gentileza apresentar PLANO DE ..."},{"dt":"2025-11-11","st":"Conclu√≠do","cat":"Avaria","desc":"Referente SOLICITACAO DE BAIXA DE ESTOQUE POR AVARIA - REG-44754-763 , gentileza apresentar PLANO DE..."},{"dt":"2025-11-24","st":"Pendente","cat":"Outros","desc":"Constata√ß√£o de ANOMALIA de SOBRAS, em 13NOV25, em TCV (REG 14653-624) que totalizou R$ 547,27, para ..."}]},
    {"filial":"TPH","responsavel":"Gerusa Ribeiro","anomalias":1,"planos":4,"status":"Atrasado","diretoria":"Financeiro","detalhes":[{"dt":"2025-11-01","st":"Atrasado","cat":"Outros","desc":"Temos 3 boletos em aberto da Vancar, vencido no dia 30/10 e ainda n√£o foi enviado para pagamento. ..."}]},
    {"filial":"TPH","responsavel":"Laudinil Souza Penteado","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-13","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TPH apresentou R$ 4.071.314,62 em devolu√ß√µes, com p..."}]},
    {"filial":"TPH","responsavel":"Luiz Silva","anomalias":5,"planos":3,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-10-28","st":"Conclu√≠do","cat":"Fiscal/Financeiro","desc":"Em 28/10/2025 tiveram 06 notas da Qu√≠mica Amparo que foram informadas sem estarem inclu√≠das no CAP, ..."},{"dt":"2025-11-10","st":"Conclu√≠do","cat":"Diverg√™ncia","desc":"Identificado falha no processo de recebimento de cargas (confer√™ncia cega), onde a quantidade f√≠sica..."},{"dt":"2025-11-14","st":"Pendente","cat":"Fiscal/Financeiro","desc":"Identificado notas fiscais de entrada lan√ßadas sem o v√≠nculo com o pedido de compra, gerando diverg√™..."},{"dt":"2025-11-18","st":"Pendente","cat":"Outros","desc":"Port√£o da doca 3 com problemas no motor, dificultando a opera√ß√£o de descarga. Necess√°rio reparo urg..."},{"dt":"2025-11-19","st":"Pendente","cat":"Avaria","desc":"Identificado vazamento no telhado sobre a √°rea de armazenagem de itens de alto valor (HPC). Risco de..."}]},
    {"filial":"TPH","responsavel":"Magno Souza","anomalias":1,"planos":1,"status":"Em Dia","diretoria":"Logistica","detalhes":[{"dt":"2025-11-13","st":"Em Dia","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TPH apresentou um total de R$ 3.829.517,77 em devol..."}]},
    {"filial":"TPH","responsavel":"Rodrigo Bertoni","anomalias":8,"planos":5,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-10-29","st":"Conclu√≠do","cat":"Vencimento/FEFO","desc":"Produtos de FEFO vencidos dentro do CD. Falta de a√ß√£o comercial para venda ou transfer√™ncia antes do..."},{"dt":"2025-10-31","st":"Conclu√≠do","cat":"Vencimento/FEFO","desc":"Produtos de FEFO vencidos dentro do CD..."},{"dt":"2025-10-31","st":"Pendente","cat":"Vencimento/FEFO","desc":"Produtos de FEFO vencidos dentro do CD..."},{"dt":"2025-11-04","st":"Conclu√≠do","cat":"Vencimento/FEFO","desc":"Produtos de FEFO vencidos dentro do CD..."},{"dt":"2025-11-07","st":"Conclu√≠do","cat":"Vencimento/FEFO","desc":"Produtos de FEFO vencidos dentro do CD..."},{"dt":"2025-11-13","st":"Pendente","cat":"Vencimento/FEFO","desc":"Produtos de FEFO vencidos dentro do CD..."},{"dt":"2025-11-13","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TPH apresentou R$ 3.829.517,77 em devolu√ß√µes, sendo..."},{"dt":"2025-11-21","st":"Em Dia","cat":"Vencimento/FEFO","desc":"Tratando como chegamos a ter mais de 500 mil em produtos vencidos e ter mais de 300 mil em produtos ..."}]},
    {"filial":"TPH","responsavel":"Ronaldo Crispim","anomalias":10,"planos":0,"status":"Pendente","diretoria":"Logistica","detalhes":[{"dt":"2025-11-11","st":"Pendente","cat":"Diverg√™ncia","desc":"Ajustes de estoque realizados sem justificativa clara no sistema WMS..."},{"dt":"2025-11-11","st":"Pendente","cat":"Diverg√™ncia","desc":"Diverg√™ncia de estoque no item 102030 (Arroz 5kg), f√≠sico maior que sist√™mico..."},{"dt":"2025-11-11","st":"Pendente","cat":"Diverg√™ncia","desc":"Diverg√™ncia de estoque no item 405060 (Sab√£o em P√≥), f√≠sico menor que sist√™mico..."},{"dt":"2025-11-11","st":"Pendente","cat":"Avaria","desc":"Palete PBR quebrado na posi√ß√£o A-12-03, risco de queda de mercadoria..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Lixo acumulado no corredor 4, dificultando a passagem de empilhadeiras..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Extintor de inc√™ndio da doca 2 com validade vencida..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Luz de emerg√™ncia do setor de expedi√ß√£o queimada..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Empilhadeira 03 apresentando vazamento de √≥leo..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Transpaleteira manual 05 com roda travada..."},{"dt":"2025-11-11","st":"Pendente","cat":"Outros","desc":"Colaborador sem EPI (botina) na √°rea operacional..."}]},
    {"filial":"TSJ","responsavel":"Ana Cristina","anomalias":1,"planos":3,"status":"Em Dia","diretoria":"Comercial","detalhes":[{"dt":"2025-11-13","st":"Em Dia","cat":"Fiscal/Financeiro","desc":"Inadimplencia de cliente que tinha restri√ß√£o de compra 1 - Por que?  R.: Foi liberado a venda, pois ..."}]},
    {"filial":"TSJ","responsavel":"Carlos Saldanha","anomalias":7,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"Nota de Troca com Produto Fora do Prazo..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"Nota de Troca com Produto Fora do Prazo..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"Nota de Troca com Produto Fora do Prazo..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"Nota de Troca com Produto Fora do Prazo..."},{"dt":"2025-10-30","st":"Pendente","cat":"Vencimento/FEFO","desc":"Nota de Troca com Produto Fora do Prazo..."},{"dt":"2025-11-04","st":"Pendente","cat":"Avaria","desc":"NF de trocas com produtos avariados..."},{"dt":"2025-11-18","st":"Pendente","cat":"Diverg√™ncia","desc":"Nota de Troca com Produto a mais ..."}]},
    {"filial":"TSJ","responsavel":"Cristiano Rodrigues","anomalias":1,"planos":0,"status":"Pendente","diretoria":"Comercial","detalhes":[{"dt":"2025-11-12","st":"Pendente","cat":"Devolu√ß√£o","desc":"No per√≠odo de 01/01/2025 a 31/10/2025, a unidade TSJ apresentou R$ 511.458,56 em devolu√ß√µes, sendo a..."}]},
    {"filial":"TSJ","responsavel":"Fabricio Ribeiro","anomalias":4,"planos":6,"status":"Em Dia","diretoria":"Logistica","detalhes":[{"dt":"2025-11-10","st":"Conclu√≠do","cat":"Outros","desc":"Sensor de presen√ßa do corredor 3 disparando aleatoriamente..."},{"dt":"2025-11-10","st":"Conclu√≠do","cat":"Outros","desc":"Port√£o autom√°tico da entrada principal travando..."},{"dt":"2025-11-11","st":"Em Dia","cat":"Outros","desc":"Vazamento na torneira do banheiro masculino..."},{"dt":"2025-11-12","st":"Conclu√≠do","cat":"Outros","desc":"L√¢mpada do escrit√≥rio queimada..."}]}
];

        // =================================================================
        // L√ìGICA DE ACESSO (DIRETORIA APENAS)
        // =================================================================
        
        const CREDENCIAIS = {
            'admin': {pass:'admin123', view:'TODOS', name:'Administrador'},
            'ademir': {pass:'log123', view:'Logistica', name:'Ademir Lobato'},
            'saulo': {pass:'com123', view:'Comercial', name:'Saulo'},
            'ana': {pass:'rh123', view:'Gente', name:'Ana'},
            'fagnes': {pass:'fin123', view:'Financeiro', name:'Fagnes'},
            'luis': {pass:'prev123', view:'Prevencao', name:'Lu√≠s'}
        };

        let usuarioLogado = null;
        let ordenacao = { col: 'anomalias', dir: 'desc' };

        function handleEnter(e) { if(e.key==='Enter') fazerLogin(); }

        function fazerLogin() {
            const u = document.getElementById('user').value.toLowerCase().trim();
            const p = document.getElementById('pass').value;
            
            if(CREDENCIAIS[u] && CREDENCIAIS[u].pass === p) {
                acessar(CREDENCIAIS[u]);
            } else {
                document.getElementById('errorMsg').style.display='block';
            }
        }

        function acessar(user) {
            usuarioLogado = user;
            
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('dashboardContainer').style.display = 'block';
            document.getElementById('userBadge').innerText = user.name;

            // Configura filtro visual de diretoria
            const selDir = document.getElementById('filtroDiretoria');
            selDir.innerHTML = `
                <option value="TODOS">-- Vis√£o Geral --</option>
                <option value="Logistica">Log√≠stica</option>
                <option value="Comercial">Comercial</option>
                <option value="Gente">Gente e Gest√£o</option>
                <option value="Financeiro">Financeiro</option>
                <option value="Prevencao">Preven√ß√£o</option>
            `;
            
            selDir.value = user.view;
            
            // Trava se n√£o for Admin (TODOS)
            if(user.view !== 'TODOS') {
                selDir.disabled = true; 
                selDir.style.background = '#eee';
                selDir.style.color = '#555';
            }

            renderizarDashboard();
        }

        function logout() { location.reload(); }

        function alterarFiltroDiretoria(val) {
            // S√≥ Admin consegue usar isso
            usuarioLogado.view = val;
            renderizarDashboard();
        }

        // =================================================================
        // RENDERIZA√á√ÉO
        // =================================================================

        function renderizarDashboard() {
            let dados;

            // Filtra pela vis√£o do usu√°rio (ou sele√ß√£o do admin)
            if (usuarioLogado.view === 'TODOS') {
                dados = [...dadosBanco];
            } else {
                dados = dadosBanco.filter(d => d.diretoria === usuarioLogado.view);
            }

            // Ordena√ß√£o
            dados.sort((a,b) => {
                let vA = a[ordenacao.col], vB = b[ordenacao.col];
                if(typeof vA === 'string') return ordenacao.dir==='asc' ? vA.localeCompare(vB) : vB.localeCompare(vA);
                return ordenacao.dir==='asc' ? vA - vB : vB - vA;
            });

            // KPIs
            let total=0, pend=0, atrasado=0, conc=0;
            dados.forEach(d => {
                total += d.anomalias;
                if(d.status==='Pendente') pend+=d.anomalias;
                else if(d.status==='Atrasado') atrasado+=d.anomalias;
                else conc+=d.anomalias;
            });
            document.getElementById('kpiTotal').innerText = total;
            document.getElementById('kpiPendente').innerText = pend;
            document.getElementById('kpiAtrasado').innerText = atrasado;
            document.getElementById('kpiConcluido').innerText = conc;

            // Tabela
            const tbody = document.getElementById('tabelaCorpo');
            tbody.innerHTML = '';
            dados.forEach(d => {
                let bg = d.status==='Em Dia'?'bg-concluido':(d.status==='Atrasado'?'bg-atrasado':(d.status==='Conclu√≠do'?'bg-concluido':'bg-pendente'));
                let tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${d.filial}</strong></td>
                    <td><a class="link-nome" onclick='abrirDetalhes(${JSON.stringify(d)})'>${d.responsavel}</a></td>
                    <td style="text-align:center;">${d.anomalias}</td>
                    <td style="text-align:center;">${d.planos}</td>
                    <td style="text-align:center;"><span class="badge ${bg}">${d.status}</span></td>
                    <td><button onclick='abrirDetalhes(${JSON.stringify(d)})' style="cursor:pointer; border:1px solid #ccc; background:#fff; border-radius:4px;">üîç Ver</button></td>
                `;
                tbody.appendChild(tr);
            });

            renderizarGraficos(dados);
        }

        function renderizarGraficos(dados) {
            let statusMap = {'Pendente':0, 'Atrasado':0, 'Conclu√≠do':0};
            dados.forEach(d => {
                let s = (d.status==='Em Dia' || d.status==='Conclu√≠do') ? 'Conclu√≠do' : d.status;
                statusMap[s] += d.anomalias;
            });

            let ctxS = document.getElementById('chartStatus').getContext('2d');
            if(window.chartS instanceof Chart) window.chartS.destroy();
            window.chartS = new Chart(ctxS, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(statusMap),
                    datasets: [{ data: Object.values(statusMap), backgroundColor: ['#dc3545','#fd7e14','#28a745'] }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { title: {display:true, text:'Status Geral'} } }
            });

            let top = [...dados].sort((a,b) => b.anomalias - a.anomalias).slice(0, 5);
            let ctxR = document.getElementById('chartResponsavel').getContext('2d');
            if(window.chartR instanceof Chart) window.chartR.destroy();
            window.chartR = new Chart(ctxR, {
                type: 'bar',
                data: {
                    labels: top.map(d => d.responsavel.split(' ')[0]),
                    datasets: [{ label: 'Qtd', data: top.map(d => d.anomalias), backgroundColor: '#0056b3' }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: {display:false}, title: {display:true, text:'Top 5 Ofensores'} } }
            });
        }

        function ordenar(col) {
            ordenacao.dir = (ordenacao.col === col && ordenacao.dir === 'desc') ? 'asc' : 'desc';
            ordenacao.col = col;
            renderizarDashboard();
        }

        function abrirDetalhes(item) {
            document.getElementById('modalTitulo').innerText = item.responsavel;
            document.getElementById('modalSubtitulo').innerText = `${item.filial} | ${item.diretoria}`;
            const tbody = document.getElementById('modalCorpo');
            tbody.innerHTML = '';
            
            item.detalhes.forEach(det => {
                let badgeClass = det.status==='Pendente'?'bg-pendente':(det.status==='Conclu√≠do'?'bg-concluido':'bg-atrasado');
                let tr = `<tr>
                    <td>${det.data}</td>
                    <td><span class="badge ${badgeClass}">${det.status}</span></td>
                    <td><span class="cat-tag">${det.cat}</span></td>
                    <td style="color:#666;">${det.desc}</td>
                </tr>`;
                tbody.innerHTML += tr;
            });
            document.getElementById('detalhesModal').style.display = 'block';
        }
        function fecharModal() { document.getElementById('detalhesModal').style.display = 'none'; }
        window.onclick = function(e) { if(e.target == document.getElementById('detalhesModal')) fecharModal(); }
    </script>
</body>
</html>
